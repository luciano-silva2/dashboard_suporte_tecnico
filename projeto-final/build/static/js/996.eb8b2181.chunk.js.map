{"version":3,"file":"static/js/996.eb8b2181.chunk.js","mappings":"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","sources":["Pages/Tickets/Modal.jsx","Pages/Tickets/AtenderTicketButton.jsx","Pages/Tickets/TicketsExibicao.jsx","Pages/Tickets/Tickets.jsx","Pages/Tickets/ticketsUtils.js"],"sourcesContent":["const Modal = ({ isOpen, onClose, children }) => {\n  if (!isOpen) return null;\n\n  return (\n    <div\n      style={{\n        position: 'fixed',\n        top: 0,\n        left: 0,\n        width: '100%',\n        height: '100%',\n        background: 'rgba(0, 0, 0, 0.5)',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        zIndex: 2000,\n      }}\n      onClick={onClose}\n    >\n      <div\n        style={{\n          background: 'white',\n          padding: '20px',\n          borderRadius: '8px',\n          boxShadow: '0 4px 8px rgba(0, 0, 0, 0.1)',\n          position: 'relative',\n          zIndex: 2001,\n        }}\n        onClick={(e) => e.stopPropagation()}\n      >\n        {children}\n        <button onClick={onClose}>Close</button>\n      </div>\n    </div>\n  );\n};\n\nexport default Modal;\n","import { useState, useMemo } from \"react\";\nimport { doc, runTransaction, serverTimestamp } from \"firebase/firestore\";\nimport { firestore } from \"../../Firebase/firebase\";\n\nexport default function AtenderTicketButton({ ticket, currentUser, isFuncionario, onAfter }) {\n  const [loading, setLoading] = useState(false);\n\n  // Calcula se o botão deve aparecer\n  const podeAtender = useMemo(() => {\n    return isFuncionario && ticket?.status === \"aberto\" && !ticket?.funcionarioId;\n  }, [isFuncionario, ticket]);\n\n  const handleAtender = async () => {\n    if (!podeAtender) return;\n    setLoading(true);\n\n    try {\n      const ref = doc(firestore, \"tickets\", ticket.id);\n\n      await runTransaction(firestore, async (tx) => {\n        const snap = await tx.get(ref);\n        if (!snap.exists()) throw new Error(\"Ticket não encontrado.\");\n        const data = snap.data();\n        if (data.funcionarioId) throw new Error(\"Ticket já foi assumido.\");\n        if (data.status !== \"aberto\") throw new Error(\"Ticket não está mais aberto.\");\n\n        tx.update(ref, {\n          funcionarioId: currentUser.uid,\n          status: \"em_andamento\",\n          assumidoEm: serverTimestamp(),\n          atualizadoEm: serverTimestamp(),\n        });\n      });\n\n      onAfter?.();\n    } catch (e) {\n      alert(e.message || \"Erro ao atender ticket.\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (!podeAtender) return null;\n\n  return (\n    <button\n      className=\"btn btn-warning btn-sm\"\n      onClick={handleAtender}\n      disabled={loading}\n      title=\"Assumir este ticket\"\n    >\n      {loading ? \"Assumindo...\" : \"Atender\"}\n    </button>\n  );\n}\n","import React, { useMemo, useState } from \"react\";\nimport { MaterialReactTable } from 'material-react-table';\nimport Select from 'react-select';\nimport DatePicker from 'react-datepicker';\nimport 'react-datepicker/dist/react-datepicker.css';\nimport { exportarCSV, prioridades, statusOptions } from './ticketsUtils';\nimport Modal from \"./Modal\";\nimport AtenderTicketButton from \"./AtenderTicketButton\";\nimport { auth, db } from '../../Firebase/firebase';\nimport { collection, addDoc, serverTimestamp } from \"firebase/firestore\";\n\nexport default function TicketsExibicao({\n    setTicketSelecionado,\n    navigate,\n    ticketsFiltrados,\n    atualizarCampo,\n    excluirTicket,\n    isFuncionario,\n}) {\n    const [isModalOpen, setIsModalOpen] = useState(false);\n    const [selectedTicket, setSelectedTicket] = useState(null);\n    const [novoTicket, setNovoTicket] = useState({\n        nome: '',\n        email: '',\n        problema: '',\n        prioridade: null,\n        status: null,\n        tecnico: '',\n        data: new Date(),\n    });\n\n    const abrirModalNovoTicket = () => {\n        setSelectedTicket(null);\n        const user = auth.currentUser;\n        setNovoTicket({\n            nome: user?.displayName || '',\n            email: user?.email || '',\n            problema: '',\n            prioridade: null,\n            status: null,\n            tecnico: '',\n            data: new Date(),\n        });\n        setIsModalOpen(true);\n    };\n\n    const salvarNovoTicket = async () => {\n        try {\n            await addDoc(collection(db, 'tickets'), {\n                ...novoTicket,\n                prioridade: novoTicket.prioridade?.value || null,\n                status: novoTicket.status?.value || null,\n                data: novoTicket.data || serverTimestamp(),\n            });\n            alert('Ticket criado com sucesso!');\n            setIsModalOpen(false);\n        } catch (e) {\n            console.error(e);\n            alert('Erro ao criar ticket.');\n        }\n    };\n\n    const columns = useMemo(() => [\n        { accessorKey: 'nome', header: 'Nome' },\n        { accessorKey: 'email', header: 'Email' },\n        { accessorKey: 'problema', header: 'Problema' },\n        {\n            accessorKey: 'prioridade',\n            header: 'Prioridade',\n            Cell: ({ cell, row }) => (\n                <Select\n                    value={prioridades.find(opt => opt.value === cell.getValue())}\n                    onChange={selected => atualizarCampo(row.original.id, 'prioridade', selected.value)}\n                    options={prioridades}\n                    classNamePrefix=\"react-select\"\n                />\n            ),\n        },\n        {\n            accessorKey: 'status',\n            header: 'Status',\n            Cell: ({ cell, row }) => (\n                <Select\n                    value={statusOptions.find(opt => opt.value === cell.getValue())}\n                    onChange={selected => atualizarCampo(row.original.id, 'status', selected.value)}\n                    options={statusOptions}\n                    classNamePrefix=\"react-select\"\n                />\n            ),\n        },\n        { accessorKey: 'tecnico', header: 'Técnico' },\n        {\n            accessorKey: 'data',\n            header: 'Data',\n            Cell: ({ cell }) => new Date(cell.getValue()).toLocaleDateString(),\n        },\n        {\n            accessorKey: 'acoes',\n            header: 'Ações',\n            Cell: ({ row }) => (\n                <div className=\"d-flex gap-2\">\n                    <button\n                        className=\"btn btn-info btn-sm\"\n                        onClick={() => {\n                            setSelectedTicket(row.original);\n                            setIsModalOpen(true);\n                        }}\n                    >\n                        Ver Detalhes\n                    </button>\n                    <button\n                        className=\"btn btn-danger btn-sm\"\n                        onClick={() => excluirTicket(row.original.id)}\n                    >\n                        Excluir\n                    </button>\n                    <button\n                        className=\"btn btn-primary btn-sm\"\n                        onClick={() => {\n                            navigate(\"/chat\");\n                        }}\n                    >\n                        Abrir Chat\n                    </button>\n                    {isFuncionario && row.original.status === \"aberto\" && !row.original.funcionarioId && (\n                        <AtenderTicketButton\n                            ticket={row.original}\n                            currentUser={auth.currentUser}\n                            isFuncionario={isFuncionario}\n                            onAfter={() => {}}\n                        />\n                    )}\n                </div>\n            )\n        },\n    ], [atualizarCampo, excluirTicket, isFuncionario]);\n\n    return (\n        <div className=\"container my-4\">\n            <Modal isOpen={isModalOpen} onClose={() => setIsModalOpen(false)}>\n                {selectedTicket ? (\n                    <div>\n                        <h5>Detalhes do Ticket</h5>\n                        <p><strong>Nome:</strong> {selectedTicket.nome}</p>\n                        <p><strong>Email:</strong> {selectedTicket.email}</p>\n                        <p><strong>Problema:</strong> {selectedTicket.problema}</p>\n                        <p><strong>Prioridade:</strong> {selectedTicket.prioridade}</p>\n                        <p><strong>Status:</strong> {selectedTicket.status}</p>\n                        <p><strong>Técnico:</strong> {selectedTicket.tecnico}</p>\n                        <p><strong>Data:</strong> {selectedTicket.data?.toLocaleDateString()}</p>\n                    </div>\n                ) : (\n                    <div>\n                        <h5>Criar Novo Ticket</h5>\n                        <input\n                            className=\"form-control mb-2\"\n                            placeholder=\"Problema\"\n                            value={novoTicket.problema}\n                            onChange={e => setNovoTicket({...novoTicket, problema: e.target.value})}\n                        />\n                        <Select\n                            options={prioridades}\n                            value={novoTicket.prioridade}\n                            onChange={opt => setNovoTicket({...novoTicket, prioridade: opt})}\n                            placeholder=\"Prioridade\"\n                            classNamePrefix=\"react-select\"\n                        />\n                        <Select\n                            options={statusOptions}\n                            value={novoTicket.status}\n                            onChange={opt => setNovoTicket({...novoTicket, status: opt})}\n                            placeholder=\"Status\"\n                            classNamePrefix=\"react-select\"\n                        />\n                        <input\n                            className=\"form-control mt-2\"\n                            placeholder=\"Técnico\"\n                            value={novoTicket.tecnico}\n                            onChange={e => setNovoTicket({...novoTicket, tecnico: e.target.value})}\n                        />\n                        <DatePicker\n                            selected={novoTicket.data}\n                            onChange={date => setNovoTicket({...novoTicket, data: date})}\n                            className=\"form-control mt-2\"\n                            dateFormat=\"dd/MM/yyyy\"\n                        />\n                        <button className=\"btn btn-primary mt-3\" onClick={salvarNovoTicket}>Salvar</button>\n                    </div>\n                )}\n            </Modal>\n\n            <div className=\"d-flex justify-content-between mb-3\">\n                <button className=\"btn btn-success\" onClick={abrirModalNovoTicket}>+ Novo Ticket</button>\n                <button className=\"btn btn-danger\" onClick={() => exportarCSV(ticketsFiltrados)}>Exportar CSV</button>\n            </div>\n\n            <MaterialReactTable\n                columns={columns}\n                data={ticketsFiltrados}\n                enablePagination\n                initialState={{ pagination: { pageSize: 5 } }}\n                muiTableProps={{ className: 'table-striped table-hover' }}\n                enableSorting\n            />\n        </div>\n    );\n}\n","import React, { useState, useEffect, useMemo, useCallback } from \"react\";\nimport { useNavigate } from 'react-router-dom';\nimport { db } from '../../Firebase/firebase';\nimport { collection, onSnapshot, deleteDoc, doc, updateDoc } from 'firebase/firestore';\nimport { filtrarTickets } from './ticketsUtils';\nimport TicketsExibicao from \"./TicketsExibicao\";\nimport { useUser } from \"../../context/UserContext\";\n\nexport default function Tickets({ setTicketSelecionado }) {\n  const navigate = useNavigate();\n  const { userData } = useUser();\n  const isFuncionario = userData?.tipo === \"funcionario\";\n\n  const [tickets, setTickets] = useState([]);\n  const [searchInput, setSearchInput] = useState('');\n  const [searchTerm, setSearchTerm] = useState('');\n  const [filtroStatus, setFiltroStatus] = useState(null);\n  const [filtroPrioridade, setFiltroPrioridade] = useState(null);\n  const [filtroDataInicial, setFiltroDataInicial] = useState(null);\n  const [filtroDataFinal, setFiltroDataFinal] = useState(null);\n  const [filtroTecnico, setFiltroTecnico] = useState(null);\n\n  useEffect(() => {\n    const handler = setTimeout(() => {\n      setSearchTerm(searchInput.trim().toLowerCase());\n    }, 500);\n    return () => clearTimeout(handler);\n  }, [searchInput]);\n\n  useEffect(() => {\n    const unsubscribe = onSnapshot(collection(db, 'tickets'), (snapshot) => {\n      const dados = snapshot.docs.map(doc => ({\n        id: doc.id,\n        ...doc.data(),\n        data: doc.data().data?.toDate?.() || new Date()\n      }));\n      setTickets(dados);\n    });\n    return () => unsubscribe();\n  }, []);\n\n  const excluirTicket = useCallback(async (id) => {\n    try {\n      await deleteDoc(doc(db, 'tickets', id));\n      alert('Ticket excluído com sucesso');\n    } catch (erro) {\n      console.log(erro);\n    }\n  }, []);\n\n  const atualizarCampo = useCallback(async (id, campo, valor) => {\n    try {\n      const ref = doc(db, 'tickets', id);\n      await updateDoc(ref, { [campo]: valor });\n    } catch (erro) {\n      console.error(`Erro ao atualizar ${campo}:`, erro);\n    }\n  }, []);\n\n  const ticketsFiltrados = useMemo(() => {\n    return filtrarTickets(tickets, {\n      searchTerm,\n      filtroStatus,\n      filtroPrioridade,\n      filtroDataInicial,\n      filtroDataFinal,\n      filtroTecnico,\n    });\n  }, [tickets, searchTerm, filtroStatus, filtroPrioridade, filtroDataInicial, filtroDataFinal, filtroTecnico]);\n\n  return (\n    <TicketsExibicao\n      setTicketSelecionado={setTicketSelecionado}\n      navigate={navigate}\n      ticketsFiltrados={ticketsFiltrados}\n      atualizarCampo={atualizarCampo}\n      excluirTicket={excluirTicket}\n      isFuncionario={isFuncionario}\n    />\n  );\n}\n","import jsPDF from 'jspdf';\nimport 'jspdf-autotable';\nimport { saveAs } from 'file-saver';\n\nexport const prioridades = [\n  { value: 'urgente', label: 'Urgente' },\n  { value: 'alta', label: 'Alta' },\n  { value: 'media', label: 'Média' },\n  { value: 'baixa', label: 'Baixa' }\n];\n\nexport const statusOptions = [\n  { value: 'aberto', label: 'Aberto' },\n  { value: 'em_andamento', label: 'Em andamento' },\n  { value: 'resolvido', label: 'Resolvido' },\n  { value: 'cancelado', label: 'Cancelado' }\n];\n\nexport const tecnicos = [\n  { value: 'joao', label: 'João' },\n  { value: 'ana', label: 'Ana' },\n  { value: 'maria', label: 'Maria' }\n];\n\nexport function filtrarTickets(tickets, filtros) {\n  const {\n    searchTerm,\n    filtroStatus,\n    filtroPrioridade,\n    filtroDataInicial,\n    filtroDataFinal,\n    filtroTecnico,\n  } = filtros;\n\n  return tickets.filter(ticket => {\n    const termo = searchTerm?.toLowerCase() || \"\";\n\n\n    const matchesSearch =\n      !termo ||\n      ticket.nome?.toLowerCase().includes(termo) ||\n      ticket.problema?.toLowerCase().includes(termo) ||\n      ticket.email?.toLowerCase().includes(termo);\n\n    const matchesStatus = filtroStatus ? ticket.status === filtroStatus.value : true;\n    const matchesPrioridade = filtroPrioridade ? ticket.prioridade === filtroPrioridade.value : true;\n    const matchesData =\n      (!filtroDataInicial || ticket.data >= filtroDataInicial) &&\n      (!filtroDataFinal || ticket.data <= filtroDataFinal);\n    const matchesTecnico = filtroTecnico ? ticket.tecnico === filtroTecnico.value : true;\n\n    return matchesSearch && matchesStatus && matchesPrioridade && matchesData && matchesTecnico;\n  });\n}\n\nexport function exportarCSV(tickets) {\n\n  const cabecalho = [\"Nome\", \"Email\", \"Problema\", \"Prioridade\", \"Status\", \"Técnico\", \"Data\"];\n  \n  const linhas = tickets.map(t => [\n    t.nome,\n    t.email || '',\n    t.problema,\n    t.prioridade,\n    t.status,\n    t.tecnico,\n    t.data?.toLocaleDateString?.() || ''\n  ]);\n\n  const csvContent = [\n    cabecalho.join(\",\"),\n    ...linhas.map(linha => linha.map(escapeCSV).join(\",\"))\n  ].join(\"\\n\");\n\n  const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\n  saveAs(blob, 'tickets.csv');\n}\n\nfunction escapeCSV(valor) {\n  if (typeof valor === 'string' && (valor.includes(',') || valor.includes('\"') || valor.includes('\\n'))) {\n    return `\"${valor.replace(/\"/g, '\"\"')}\"`;\n  }\n  return valor ?? '';\n}\n"],"names":["_ref","isOpen","onClose","children","_jsx","style","position","top","left","width","height","background","display","alignItems","justifyContent","zIndex","onClick","_jsxs","padding","borderRadius","boxShadow","e","stopPropagation","AtenderTicketButton","ticket","currentUser","isFuncionario","onAfter","loading","setLoading","useState","podeAtender","useMemo","status","funcionarioId","className","async","ref","doc","firestore","id","runTransaction","snap","tx","get","exists","Error","data","update","uid","assumidoEm","serverTimestamp","atualizadoEm","alert","message","disabled","title","TicketsExibicao","_selectedTicket$data","setTicketSelecionado","navigate","ticketsFiltrados","atualizarCampo","excluirTicket","isModalOpen","setIsModalOpen","selectedTicket","setSelectedTicket","novoTicket","setNovoTicket","nome","email","problema","prioridade","tecnico","Date","columns","accessorKey","header","Cell","_ref2","cell","row","Select","value","prioridades","find","opt","getValue","onChange","selected","original","options","classNamePrefix","_ref3","statusOptions","_ref4","toLocaleDateString","_ref5","auth","Modal","placeholder","target","DatePicker","date","dateFormat","_novoTicket$prioridad","_novoTicket$status","addDoc","collection","db","console","error","abrirModalNovoTicket","user","displayName","exportarCSV","MaterialReactTable","enablePagination","initialState","pagination","pageSize","muiTableProps","enableSorting","Tickets","useNavigate","userData","useUser","tipo","tickets","setTickets","searchInput","setSearchInput","searchTerm","setSearchTerm","filtroStatus","setFiltroStatus","filtroPrioridade","setFiltroPrioridade","filtroDataInicial","setFiltroDataInicial","filtroDataFinal","setFiltroDataFinal","filtroTecnico","setFiltroTecnico","useEffect","handler","setTimeout","trim","toLowerCase","clearTimeout","unsubscribe","onSnapshot","snapshot","dados","docs","map","_doc$data$data","_doc$data$data$toDate","toDate","call","useCallback","deleteDoc","erro","log","campo","valor","updateDoc","filtrarTickets","label","tecnicos","filtros","filter","_ticket$nome","_ticket$problema","_ticket$email","termo","matchesSearch","includes","matchesStatus","matchesPrioridade","matchesData","matchesTecnico","linhas","t","_t$data","_t$data$toLocaleDateS","csvContent","join","linha","escapeCSV","blob","Blob","type","saveAs","replace"],"sourceRoot":""}